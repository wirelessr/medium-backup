<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Building Ruby on Rails from Scratch</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Building Ruby on Rails from Scratch</h1>
</header>
<section data-field="subtitle" class="p-summary">
Day 1: From Nothing to Something
</section>
<section data-field="body" class="e-content">
<section name="9990" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="d939" id="d939" class="graf graf--h3 graf--leading graf--title">Building Ruby on Rails from Scratch</h3><h4 name="feb3" id="feb3" class="graf graf--h4 graf-after--h3 graf--subtitle">Day 1: From Nothing to Something</h4><figure name="5db7" id="5db7" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="0*WjGtHzKNjv6ka8vW.png" data-width="500" data-height="700" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*WjGtHzKNjv6ka8vW.png"><figcaption class="imageCaption"><a href="https://dev.to/rly" data-href="https://dev.to/rly" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://dev.to/rly</a></figcaption></figure><ul class="postList"><li name="7112" id="7112" class="graf graf--li graf-after--figure">Day 1: <a href="https://lazypro.medium.com/building-ruby-on-rails-from-scratch-b855584ff4f8" data-href="https://lazypro.medium.com/building-ruby-on-rails-from-scratch-b855584ff4f8" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">From Nothing to Something</a></li><li name="88de" id="88de" class="graf graf--li graf-after--li">Day 2: <a href="https://lazypro.medium.com/building-ruby-on-rails-from-scratch-day-2-d609fce59811" data-href="https://lazypro.medium.com/building-ruby-on-rails-from-scratch-day-2-d609fce59811" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">More Things about Relations, Tests, etc.</a></li><li name="f4f3" id="f4f3" class="graf graf--li graf-after--li">Day 3: <a href="https://lazypro.medium.com/ae31c975bf32" data-href="https://lazypro.medium.com/ae31c975bf32" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">My Thoughts on Ruby</a></li></ul><p name="c51e" id="c51e" class="graf graf--p graf-after--li">I have changed my job a while ago, so I will take some time to pick up the architecture and services of the new organization. However, in order to practice my English and take notes, I will still try to post as often as possible once a week, but the content will be different from the past, from an introduction to software architecture to my Ruby learning experience.</p><p name="4cb7" id="4cb7" class="graf graf--p graf-after--p">Because the programming language used in my new job is Ruby, and I have no experience with Ruby before. Therefore, this series will focus on the perspective of someone who already knows multiple languages and how to quickly get started with Ruby on Rails, not to write perfect Ruby, but to be able to quickly build a workable application. By the way, it’s a bit like how I learned English, there’s no structure at all, it just works and can be communicated anyway.</p><h3 name="0459" id="0459" class="graf graf--h3 graf-after--p">Installation</h3><p name="5cd1" id="5cd1" class="graf graf--p graf-after--h3">My work machine is a MacPro M1, so all operations will be Mac-based. M1 is also a very important keyword, and I stepped on several traps on M1, which will be described in a later article.</p><p name="6225" id="6225" class="graf graf--p graf-after--p">Because I need to install many versions of Ruby, I use a similar solution to <code class="markup--code markup--p-code">nvm</code>, <code class="markup--code markup--p-code"><a href="https://rvm.io/" data-href="https://rvm.io/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">rvm</a></code>.</p><p name="ed54" id="ed54" class="graf graf--p graf-after--p">To install rvm on a Mac, we first have to install gnupg.</p><blockquote name="d1fd" id="d1fd" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">$ brew install gnupg</em></blockquote><p name="0f82" id="0f82" class="graf graf--p graf-after--blockquote">Then just follow the steps on the official website.</p><blockquote name="946f" id="946f" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">$ gpg — recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB<br>$ curl -sSL </em><a href="https://get.rvm.io/" data-href="https://get.rvm.io/" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank"><em class="markup--em markup--blockquote-em">https://get.rvm.io</em></a><em class="markup--em markup--blockquote-em"> | bash<br>$ rvm install 2.7<br>$ rvm 2.7 — default</em></blockquote><p name="0fc8" id="0fc8" class="graf graf--p graf-after--blockquote">Finally, just install Rails. I know there are newer versions of Rails already available, but the resources I have on hand are based on <code class="markup--code markup--p-code">5.x</code>, so I chose to install <code class="markup--code markup--p-code">5.2.8</code>.</p><blockquote name="5467" id="5467" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">$ gem install rails -v 5.2.8</em></blockquote><h3 name="4f79" id="4f79" class="graf graf--h3 graf-after--blockquote">Start building a Rails application</h3><p name="10d6" id="10d6" class="graf graf--p graf-after--h3">First, let me describe my goal. I want to make a simple web store with two objects, user and store, where the relationship between these two objects is a one-to-one mapping. Also, using MongoDB instead of the built-in SQLite.</p><p name="4938" id="4938" class="graf graf--p graf-after--p">Building a Rails application can be done easily with <code class="markup--code markup--p-code">scaffold</code>, which provides a fully resource-based, standard RESTful API.</p><p name="cfd6" id="cfd6" class="graf graf--p graf-after--p">Start by creating a project.</p><blockquote name="dbf4" id="dbf4" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">$ rails new hello_rails<br>$ cd hello_rails<br>$ bin/rails server</em></blockquote><p name="e587" id="e587" class="graf graf--p graf-after--blockquote">At this point, the application has been created and is working on the 3000 port. Connect directly to <code class="markup--code markup--p-code">http://localhost:3000</code> and you will see the welcome page.</p><p name="0870" id="0870" class="graf graf--p graf-after--p">Next, we create the first model, starting with the user’s first and last name.</p><blockquote name="c9ee" id="c9ee" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">$ bin/rails generate scaffold User first_name last_name<br>$ bin/rails db:migrate</em></blockquote><p name="4e6b" id="4e6b" class="graf graf--p graf-after--blockquote">The user model has been created so far, and if you connect directly to <code class="markup--code markup--p-code">http://localhost:3000/users</code> you will find out not only the API but also the basic UI has been generated.</p><blockquote name="38a6" id="38a6" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">We haven’t even written a single line of code yet!</em></blockquote><h3 name="87f9" id="87f9" class="graf graf--h3 graf-after--blockquote">Create new routes</h3><p name="98d8" id="98d8" class="graf graf--p graf-after--h3">Since we already have the basic API, I’d like to generate a few new API routes. Let’s take non-resource-based routes and resource-based routes as an example each.</p><p name="2891" id="2891" class="graf graf--p graf-after--p">First, a non-resource-based route. I want to create a user count function, so I need <code class="markup--code markup--p-code">/users/count</code>. I’ll attach the specific process directly at <a href="https://github.com/wirelessr/Hello-RoR/commit/ca312276607fa33d35c78a9fbed84258caeba52e" data-href="https://github.com/wirelessr/Hello-RoR/commit/ca312276607fa33d35c78a9fbed84258caeba52e" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Github commit</a>.</p><p name="01e8" id="01e8" class="graf graf--p graf-after--p">Generally speaking, what we need to do is to modify <code class="markup--code markup--p-code">config/routes.rb</code> and create a count of the corresponding controller and view.</p><p name="bf95" id="bf95" class="graf graf--p graf-after--p">Further is the resource-based routing, the concept is similar, also attached <a href="https://github.com/wirelessr/Hello-RoR/commit/ab0860bbd3e1c6e828b49ea54a3ba13931895d83" data-href="https://github.com/wirelessr/Hello-RoR/commit/ab0860bbd3e1c6e828b49ea54a3ba13931895d83" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">commit link</a>.</p><p name="8164" id="8164" class="graf graf--p graf-after--p">The only difference between the two is in <code class="markup--code markup--p-code">config/routes.rb</code>, where non-resource-based routes are built on top of <code class="markup--code markup--p-code">collection</code>, while resource-based routes are built on <code class="markup--code markup--p-code">member</code>.</p><h3 name="5ed9" id="5ed9" class="graf graf--h3 graf-after--p">Create new fields</h3><p name="fe01" id="fe01" class="graf graf--p graf-after--h3">Now we have two fields in the user model, first_name and last_name, and we will add more fields, such as gender and age, and we will add some constraints to each field.</p><p name="9054" id="9054" class="graf graf--p graf-after--p">For example, first_name and last_name must be present and cannot be blank. And gender must be one of male, female or others. Finally, age must be a natural number.</p><p name="b58e" id="b58e" class="graf graf--p graf-after--p">Let’s start by adding the gender field, i.e. <a href="https://github.com/wirelessr/Hello-RoR/commit/31d123baa0cdd1dc8097d5d735e8719c1c232bcc" data-href="https://github.com/wirelessr/Hello-RoR/commit/31d123baa0cdd1dc8097d5d735e8719c1c232bcc" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Github commit</a>.</p><p name="9efa" id="9efa" class="graf graf--p graf-after--p">The most important change is in <code class="markup--code markup--p-code">app/models/user.rb</code>. In addition to the new fields, we also add the constraints of the existing fields. Of course, remember to run migration after modifying the model.</p><blockquote name="2e35" id="2e35" class="graf graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">$ bin/rails db:migrate</em></blockquote><p name="9b79" id="9b79" class="graf graf--p graf-after--blockquote">As you can see, adding an age is as simple as <a href="https://github.com/wirelessr/Hello-RoR/commit/27d08a7281ef24185cc98d0112a08e29f8398d91" data-href="https://github.com/wirelessr/Hello-RoR/commit/27d08a7281ef24185cc98d0112a08e29f8398d91" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Github commit</a>.</p><h3 name="a0e7" id="a0e7" class="graf graf--h3 graf-after--p">From SQLite to MongoDB</h3><p name="504a" id="504a" class="graf graf--p graf-after--h3">We have implemented a user model in SQLite, but SQLite is a local database and cannot be used for distributed systems. Therefore, we will adopt a standalone database and use MongoDB, which is more flexible in terms of schema, for the subsequent development.</p><p name="acbf" id="acbf" class="graf graf--p graf-after--p">The whole migration process follows the <a href="https://www.mongodb.com/docs/mongoid/current/tutorials/getting-started-rails/#existing-application" data-href="https://www.mongodb.com/docs/mongoid/current/tutorials/getting-started-rails/#existing-application" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">official documentation</a>.</p><p name="2867" id="2867" class="graf graf--p graf-after--p">I also attach the full <a href="https://github.com/wirelessr/Hello-RoR/commit/56d726a8d14abe6a60df04f8b19114c364f679ba" data-href="https://github.com/wirelessr/Hello-RoR/commit/56d726a8d14abe6a60df04f8b19114c364f679ba" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Github commit</a>.</p><p name="c907" id="c907" class="graf graf--p graf-after--p">First rewrite the model by removing <code class="markup--code markup--p-code">ApplicationRecord</code> and adding Mongoid with its fields. Next, we completely remove all the places where <code class="markup--code markup--p-code">active_record</code> and <code class="markup--code markup--p-code">active_storage</code> are used in the source code (which is not much).</p><h3 name="bbec" id="bbec" class="graf graf--h3 graf-after--p">Afterword</h3><p name="3459" id="3459" class="graf graf--p graf-after--h3">There should be a few more articles to come on expanding this application, which is my first step into Rails.</p><p name="3107" id="3107" class="graf graf--p graf-after--p">I’ve experienced many different backend languages before, including Python, Golang, and Node, but none of them are as friendly as Ruby on Rails.</p><p name="069b" id="069b" class="graf graf--p graf-after--p">From this article, it’s easy to see that building a “standard” RESTful API with Rails is very simple, and if you don’t have any special needs, you don’t even have to write a single line of code.</p><p name="079d" id="079d" class="graf graf--p graf-after--p">Why emphasize standard RESTful APIs?</p><p name="9239" id="9239" class="graf graf--p graf-after--p">In fact, the APIs I have written in the past are not so RESTful, such as <code class="markup--code markup--p-code">${resource}/${id}</code>, and then provide GET, POST and DELETE operations, such strict routing if not generated by the framework itself, I believe few people will fully follow.</p><p name="6d56" id="6d56" class="graf graf--p graf-after--p">But Rails provides a simple <code class="markup--code markup--p-code">scaffold</code> to make things easy, and even unit tests are built in, as described in a later article.</p><p name="ce85" id="ce85" class="graf graf--p graf-after--p graf--trailing">Although I took a few days to get familiar with Ruby and Rails, it still takes a bit of time to digest and organize, so let me take a few weeks to finish my thoughts on Ruby. But I have to say, Rails is amazing to me. I can see brilliant ideas everywhere, and there are a lot of design patterns in it. Although it was a bit painful to learn a new language and framework, I still got some insights out of it.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@lazypro" class="p-author h-card">Chunting Wu</a> on <a href="https://medium.com/p/b855584ff4f8"><time class="dt-published" datetime="2022-07-18T01:11:39.499Z">July 18, 2022</time></a>.</p><p><a href="https://medium.com/@lazypro/building-ruby-on-rails-from-scratch-b855584ff4f8" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 21, 2024.</p></footer></article></body></html>